# 📊 TXT热度数据导入使用指南

> **版本**: v2.3.0  
> **更新**: 2025-09-07  
> **状态**: ✅ 功能完整，生产可用

## 🎯 功能概述

TXT热度数据导入系统是股票分析平台的核心功能，支持导入股票交易量热度数据，并自动进行概念汇总计算和个股排名分析。

## 📋 数据格式要求

### 支持的文件格式
- **文件扩展名**: `.txt`
- **编码格式**: UTF-8
- **数据分隔符**: Tab制表符 (`\t`)

### 数据结构
```
股票代码    交易日期      交易量
SH110059   2024-02-20   329585.000000
SH110059   2024-02-21   505923.000000
SZ000001   2024-02-20   1234567.000000
```

### 格式说明
- **第一列**: 股票代码 (如: SH110059, SZ000001)
- **第二列**: 交易日期 (格式: YYYY-MM-DD)
- **第三列**: 交易量 (支持整数和浮点数)
- **行数限制**: 无限制，已测试至10MB+文件
- **日期限制**: 单个文件只能包含同一交易日期的数据

## 🚀 使用流程

### 1. 登录管理系统
```
访问地址: http://localhost:8006
用户名: admin
密码: admin123
```

### 2. 进入数据导入页面
- 点击左侧菜单 "数据导入"
- 选择 "TXT热度数据导入" 区域

### 3. 选择和导入文件
- 点击 "选择TXT文件" 按钮
- 选择符合格式要求的TXT文件
- 系统自动开始导入流程

### 4. 查看导入结果
- 导入完成后在按钮下方显示结果信息
- 可切换到 "TXT导入记录" Tab查看历史记录

## ⚡ 自动计算功能

### 导入后系统自动执行以下计算：

#### 1. **概念每日汇总** (`ConceptDailySummary`)
- 计算每个概念的总交易量
- 统计概念包含的股票数量
- 计算平均交易量和最大交易量

#### 2. **个股概念排名** (`StockConceptRanking`)
- 每只股票在其所属概念中的排名
- 计算股票占概念总量的百分比
- 提供详细的排名数据

#### 3. **概念创新高检测** (`ConceptHighRecord`)
- 检测5天、10天、20天、30天周期的创新高
- 记录创新高的具体数据和时间

## 📊 数据覆盖机制

### 覆盖确认流程
1. 系统检测文件中的交易日期
2. 查询该日期是否已有导入记录
3. 如有记录，弹出覆盖确认对话框
4. 用户确认后删除原数据并重新导入

### 覆盖确认对话框示例
```
数据覆盖确认
检测到 2024-02-20 已有导入记录 (共4条)。
继续导入将删除原有数据并重新导入，此操作不可撤销。
是否确认覆盖导入？
```

## 📈 查看分析结果

### 1. 概念分析页面
- **访问**: 点击 "概念分析" 菜单
- **功能**: 
  - 查看所有概念的每日总交易量排行
  - 点击概念名称查看内部股票排名
  - 支持日期筛选和搜索

### 2. 股票查询页面  
- **访问**: 点击 "股票查询" 菜单
- **功能**: 同概念分析页面，提供相同的数据展示

### 3. TXT导入记录
- **访问**: 数据导入页面 → "TXT导入记录" Tab
- **功能**: 
  - 查看所有导入历史记录
  - 查看导入状态和统计信息
  - 重新计算指定日期的数据

## 🔧 高级功能

### 重新计算功能
- **位置**: TXT导入记录列表中的 "重新计算" 按钮
- **作用**: 重新执行指定日期的概念汇总和排名计算
- **使用场景**: 
  - 基础数据（股票信息、概念关系）更新后
  - 计算结果异常时的修复

### 实时数据更新
- 导入完成后，相关页面自动刷新显示最新数据
- 使用全局事件机制，无需手动刷新页面

## ⚠️ 注意事项和限制

### 数据要求
- ✅ 股票代码必须在系统中存在（需先导入CSV基础数据）
- ✅ 概念关系必须预先建立（通过CSV数据导入）
- ❌ 不支持混合日期的文件（一个文件只能包含同一天的数据）
- ❌ 不支持CSV格式文件（仅支持TXT格式）

### 文件格式
- ✅ 支持Tab分隔符格式
- ✅ 支持UTF-8编码
- ✅ 支持浮点数交易量（如: 329585.000000）
- ❌ 不支持逗号分隔符CSV格式
- ❌ 不支持其他编码格式

### 系统限制
- 文件大小: 建议不超过100MB
- 并发导入: 建议同时只进行一个导入操作
- 网络超时: 大文件导入最长等待30分钟

## 🚨 错误处理和故障排除

### 常见错误及解决方案

#### 1. "未解析到有效数据"
```
原因: 文件格式不符合要求
解决: 检查文件是否为Tab分隔符格式，包含正确的三列数据
```

#### 2. "数据包含多个交易日期，请分别导入"
```
原因: 单个文件包含多个不同日期的数据
解决: 将不同日期的数据分别保存为独立的TXT文件
```

#### 3. "股票代码不存在"
```
原因: TXT文件中的股票代码在系统中不存在
解决: 先通过CSV导入功能导入股票基础信息
```

#### 4. "导入超时"
```
原因: 文件过大或网络问题
解决: 
- 分割大文件为多个小文件
- 检查网络连接状态
- 稍后重试
```

### 导入失败后的处理
1. 查看具体错误信息（显示在导入按钮下方）
2. 根据错误信息修正数据格式
3. 重新尝试导入
4. 如持续失败，可查看系统日志或联系技术支持

## 📊 性能优化建议

### 文件大小建议
- **最佳**: 单文件 < 10MB，约5万条记录
- **可接受**: 单文件 < 50MB，约25万条记录  
- **最大**: 单文件 < 100MB，约50万条记录

### 导入频率建议
- 建议在非高峰时段进行大批量导入
- 每日数据建议分批次导入
- 避免同时进行多个大文件导入

## 💡 最佳实践

### 1. 数据准备
```bash
# 建议的文件命名格式
热度数据_2024-02-20.txt
热度数据_2024-02-21.txt
```

### 2. 导入顺序
```
第一步: 导入CSV基础数据（股票信息、概念关系）
第二步: 导入TXT热度数据（交易量数据）
第三步: 查看分析结果
```

### 3. 数据验证
- 导入后检查概念汇总数据是否合理
- 验证个股排名是否正确
- 确认创新高检测结果

### 4. 备份建议
- 重要数据导入前建议备份数据库
- 保留原始TXT文件作为数据源备份

## 🎯 实际使用示例

### 示例1: 导入单日热度数据
```
文件: trading_data_2024-02-20.txt
内容:
SH600000	2024-02-20	1500000.00
SH600036	2024-02-20	980000.00
SZ000001	2024-02-20	2100000.00

导入结果:
- 成功导入3条交易记录  
- 计算生成概念汇总数据
- 生成个股排名信息
```

### 示例2: 覆盖导入
```
情况: 2024-02-20已有导入记录
操作: 选择新的同日期TXT文件
结果: 弹出确认对话框 → 确认覆盖 → 删除原数据 → 重新导入
```

## 📞 技术支持

如遇到问题，请：
1. 查看导入结果中的详细错误信息
2. 检查文件格式是否符合要求
3. 运行 `./status.sh` 检查系统状态
4. 查看系统日志文件排查问题

---

**TXT热度数据导入功能已完全稳定，支持生产环境使用！** 🎉